syntax = "proto3";

enum Call {
    InvalidCall = 0;
    Connect = 1;
    Disconnect = 2;
    Read = 3;
    Write = 4;
    StartPeriodic = 5;
    StopPeriodic = 6;
    StartFilter = 7;
    StopFilter = 8;
    SetVoltage = 9;
    ReadVersion = 10;
    GetError = 11;
    Ioctl = 12;
}

enum IoctlId {
    InvalidIoctl = 0;
    GetConfig = 1;
    SetConfig = 2;
    ReadVbatt = 3;
    FiveBaudInit = 4;
    FastInit = 5;
    ClearTxBuffer = 7;
    ClearRxBuffer = 8;
    ClearPeriodic = 9;
    ClearFilters = 10;
    ClearLUT = 11;
    AddLUT = 12;
    DeleteLUT = 13;
    ReadVoltage = 14;
}

message Message {
    uint32 protocol = 1;
    uint32 rx_status = 2;
    uint32 tx_flags = 3;
    uint32 timestamp = 4;
    uint32 extra_data_index = 5;
    bytes data = 6;
}

message Config {
    uint32 parameter = 1;
    uint32 value = 2;
}

message BaseRequest {
    uint32 id = 1;
    Call call = 2;
}

message BaseResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
}

message ConnectRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 protocol = 3;
    uint32 flags = 4;
    uint32 baud = 5;
}

message ConnectResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    uint32 channel = 4;
}

message DisconnectRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
}

message ReadRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
    uint32 num = 4;
    uint32 timeout = 5;
}

message ReadResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    repeated Message messages = 4;
}

message WriteRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
    repeated Message messages = 4;
    uint32 timeout = 5;
}

message WriteResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    uint32 num = 4;
}

message StartPeriodicRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
    Message message = 4;
    uint32 interval = 5;
}

message StartPeriodicResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    uint32 message_id = 4;
}

message StopPeriodicRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
    uint32 message_id = 4;
}

message StartFilterRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
    uint32 filter_type = 4;
    Message mask = 5;
    Message pattern = 6;
    Message flow_control = 7;
}

message StartFilterResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    uint32 filter_id = 4;
}

message StopFilterRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
    uint32 filter_id = 4;
}

message SetVoltageRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 pin = 3;
    uint32 voltage = 4;
}

message ReadVersionResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    string version = 4;
}

message GetErrorResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    string error = 4;
}

message IoctlRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
    IoctlId ioctl = 4;
}

message IoctlResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    IoctlId ioctl = 4;
}

message IoctlGetConfigRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
    IoctlId ioctl = 4;
    repeated Config config = 5;
}

message IoctlGetConfigResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    IoctlId ioctl = 4;
    repeated Config config = 5;
}

message IoctlSetConfigRequest {
    uint32 id = 1;
    Call call = 2;
    uint32 channel = 3;
    IoctlId ioctl = 4;
    repeated Config config = 5;
}

message IoctlReadVbattResponse {
    uint32 id = 1;
    Call call = 2;
    uint32 code = 3;
    IoctlId ioctl = 4;
    uint32 voltage = 5;
}
